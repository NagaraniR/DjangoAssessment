<!DOCTYPE html>
<html>
<head>
<title>Leave App-Home</title>

<link rel="stylesheet" type="text/css" href="../stylesheet/bootstrap.min.css">
<script src="https://code.jquery.com/jquery-3.2.1.min.js"/>

<style>
    .Absolute-Center.is-Responsive {
      width: 100%; 
      height: 50%;
      min-width: 200px;
      max-width: 800px;
      padding: 40px;
    }
    #logo-container{
        margin: auto;
        margin-bottom: 10px;
        width:200px;
        height:30px;
    }
</style>
<script type="text/javascript" src="http://code.jquery.com/jquery-1.11.0.min.js"></script>

<script type="text/javascript">

  var userid = (geturl()["userid"]);
  var base_url = "http://127.0.0.1:8001/leave/"; 
  var id="&id="+userid; 

    function geturl(varname){
        var url = window.location.href;
        var vars = {}
        var hashes = url.split("?")[1];
        var hash = hashes.split("&");
        for (i=0; i<hash.length; i++){
            params = hash[i].split("=");
            vars[params[0]] = params[1];
        }return vars;
    }

  $(document).ready(function(){
    $.ajax({
      type: "GET",
      dataType: "json",
      url: "http://127.0.0.1:8001/leave/details/?format=json&"+id,
      contentType:'application/json',
      success: function(data){
        // successmessage = data.details.name[]
        // $("label#successmessage").text(successmessage);
        $.each(data, function(key, value){
          if(key == 'waiting_for_approval'){
            for(var i=0; i<value.length; i++){
              $('#waiting_for_approval').append("<tr><td>"+value[i].name.name+"</td>"+
              "<td>"+value[i].from_date+"</td>"+
              "<td>"+value[i].to_date+"</td>"+
              "<td>"+value[i].leave_type.catagory+"</td>"+
              "<td>"+value[i].no_days+"</td>"+
              "<td>"+value[i].reason+"</td>"+
              "<td>"+"<button id='view' class='btn btn-primary btn-xs' onclick='myFunction("+value[i].id+")'>view</button></td></tr>");
            }
            
          }

          
        });
      }     
    });
  });

  function myFunction(id){
    window.location = 'menu.html?mgrid='+userid+'&empid='+id;
  }


  </script>
  </head>
    <body>
      <div class="jumbotron" style="font-family:Georgia">
        <h2 class ="text-center">Leave Application</h2>    
      </div>
      <div class="container">
          <div>
              <label id="successmessage"></label>
          </div>
        <div class="wrapper"> <!-- for reasons -->
          <div class="main-content">
            <a href="ApplyScreen.html"><p>Apply Leave</p></a>
          </div>
          <div class="aside">
            <h6><u>Waiting For Approval List</u></h6>
            <div style="overflow:show; position:relative; width:3px; height: 0px; top: 0px;">
              <table class="table table-striped" id="waiting_for_approval">
                <thead>
                <tr>
                <th scope="row" >Name</th>
                <th scope="row">From</th>
                <th scope="row">To</th>
                <th scope="row">Type</th>
                <th scope="row">Days</th>
                <th scope="row">Reason</th>
                <th scope="row">Status</th>
              </tr>
              </thead>
              </table>  
          </div>
        </div>
      </div>
    </div>
    </body>
</html>
<!-- <thead>
            <tr>
                <th class="col-xs-1">Size</th>
                <th class="col-xs-3">Bust</th>
                <th class="col-xs-3">Waist</th>
                <th class="col-xs-5">Hips</th>
            </tr>
        </thead> -->

<!-- <table class="table table-striped">
    <thead>
      <tr>
        <th>Firstname</th>
        <th>Lastname</th>
        <th>Email</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>John</td>
        <td>Doe</td>
        <td>john@example.com</td>
      </tr>
      <tr>
        <td>Mary</td>
        <td>Moe</td>
        <td>mary@example.com</td>
      </tr>
      <tr>
        <td>July</td>
        <td>Dooley</td>
        <td>july@example.com</td>
      </tr>
    </tbody>
  </table> -->
