<!DOCTYPE html>
<html lang="en">
<head>
    <title>JavaScript - read JSON from URL</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/home/linuxuser/Desktop/Leave/DjangoAssessment/myproject/leave/static/style.css">
    <script src="/home/linuxuser/Desktop/Leave/DjangoAssessment/myproject/leave/static/jquery2.js"></script>
    <script src="/home/linuxuser/Desktop/Leave/DjangoAssessment/myproject/leave/static/jquery3.js"></script> 

    <script>
        $(function(){
            $( "#fromDate" ).datepicker({dateFormat: 'dd-mm-yy'});
            $("#toDate").datepicker({
                dateFormat: 'dd-mm-yy',
                onSelect: function(dateText, inst) {
                    var start = $(this).datepicker( 'getDate' );
                    var end = $("#fromDate").datepicker( 'getDate' );
                    // var start = $(this).val();
                    // var end = $('#toDate').val();
                    var timeDiff = Math.abs(end.getTime() - start.getTime());
                    var diffDays = Math.ceil(timeDiff / (1000 * 3600 * 24));
                    $("#days").val(diffDays)
                    // alert(diffDays); 
                    // var diff = new Date(end - start);
                    // var day = diff/1000/60/60/24;
                    // alert(Math.round(day));
                }
            });
        });
    </script>
    
    <script type="text/javascript">
        function submitfun(){
           
                // var name = $("#user").val();
                // var reporting_senior = $("#reporter").val();
                // var credits = $("#credits").val();
                // var fromDate = $("#fromDate").val();
                // var toDate = $("#toDate").val();
                // var days = $("#days").val();
                // var reason = $("#reason").val();
                var data = {
                    "name":$("#user").val(), 
                    "reporting_senior":$("#reporter").val(), 
                    "credits":$("#credits").val(), 
                    "fromDate":$("#fromDate").val(), 
                    "toDate":$("#toDate").val(), 
                    "days":$("#days").val(), 
                    "reason":$("#reason").val()
                }
                console.log(data);
               /* $.ajax({
                    type:'POST',
                    url: 'http://127.0.0.1:8000/leave/store/data/database/',
                    dataType: 'json',
                    data: data
                    success: function(result){
                        alert("dsg");
                    }
                });*/

                $.ajax({
    url: 'http://127.0.0.1:8000/leave/store/data/database/',
    dataType: 'json',
    type: 'post',
    contentType: 'application/json',
    data: data,
    processData: false,
    success: function( data, textStatus, jQxhr ){
       alert("success");
    },
    error: function( jqXhr, textStatus, errorThrown ){
       alert("err");
    }
});
            }
    </script>

<!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
 -->
    <script type="text/javascript">
        
        var base_URL = 'http://127.0.0.1:8000/leave'
        $(function(){
            // alert("ok");
            // var $user_name = $('#user')
            $.ajax({
                type: 'GET',
                url: base_URL + '/user/naga/?format=json',
                success: function(data){
                    $.each(data, function(index, data){
                        $("#user").val(data.name);
                        $("#reporter").val(data.reporting_senior);
                   });
                }
                 
            }); 
            $.ajax({
                type: 'GET',
                url : base_URL + '/credits/naga/?format=json',
                success :function(result){
                    $.each(result, function(index, result){
                        // console.log(result)
                        var credit="<option>"+result.leave_type_name +"-"+ result.available+"</option>";
                        // alert(credit);
                        $(credit).appendTo('#credits');
                   }); 
                }

            });
        });
        
    </script>
</head>
<body>
    <h1 style="color:blue;"><center> Leave Application </center></h1>
    <form class="apply" method="POST" action=" ">
        <label for="name">Name:</label>
        <input name="user" id="user"><br>
        <label for="reporter">Reporting Senior:</label>
        <input name="reporter" id="reporter"><br>
        <select id="credits" >
            <option value="select">Select Leave</option>
        </select><br>
        <label for="date">From Date:</label>
        <input id="fromDate" type="text"><br>
        <label for="date">To Date:</label>
        <input id="toDate" type="text"><br>
        <label for="day">Days:</label>
        <input id="days" type="text"><br>
        <label for="reason"> Reason: </label>
        <textarea id="reason" name="user_comment"></textarea><br>
        <button type="button" id="submit" onclick="submitfun()">Submit</button>
    </form>
    <!-- <form class="form-signin" method="POST" action="URL_OF_REST"><>
        <h1 style="color:blue;"><center> Leave Application </center></h1>
        <label for="name">Name:</label>
        <input name="user" id="user"><br>
        <label for="reporter">Reporting Senior:</label>
        <input name="reporter" id="reporter"><br>
        <select id="credits" >
            <option value="select">Select Leave</option>
        </select><br>
        <label for="date">From Date:</label>
        <input id="fromDate" type="text"><br>
        <label for="date">To Date:</label>
        <input id="toDate" type="text"><br>
        <label for="day">Days:</label>
        <input id="days" type="text"><br>
        <label for="reason"> Reason: </label>
        <textarea id="reason" name="user_comment"></textarea><br>
        <button type="button" id="submit">Submit</button> -->
</body>
</html>


<!-- <form>
        Name:<br>
        <input type="text" name="name"><br>
        Reporting Senerior:<br>
        <input type="text" name="repoting Senerior"><br>
        From Date: <input type="text" name="date"><br>
    </form> -->
